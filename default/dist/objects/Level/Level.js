"use strict";import{GameObject as m}from"../../GameObject.js";import{gridCells as i}from"../../helpers/grid.js";import{SaveGame as s}from"../../SaveGame.js";import{storyFlags as c}from"../../StoryFlags.js";export class Level extends m{constructor(o,e,t=.5){super(o),e&&(this.backgroundSound=new Audio(e),this.backgroundSound.loop=!0,this.backgroundSound.volume=t),this.noRessourceZones=[]}addChildrenGroup(o,e,t,u,d=[]){const r=Math.floor(e/i(1)),a=Math.floor(t/i(1));u.forEach(n=>{n.position.x+=e,n.position.y+=t,this.addChild(n)});const l=d.map(n=>({x1:n.x1+r,y1:n.y1+a,x2:n.x2+r,y2:n.y2+a}));this.noRessourceZones||(this.noRessourceZones=[]),this.noRessourceZones.push(...l)}checkGameProgress(){s.isInEquipment("rodPurple")&&c.add("STORY_01_PART_01"),s.isInEquipment("rodRed")&&c.add("STORY_02_PART_01")}initBackgroundSound(){s.loadSound()==="on"?this.playBackgroundSound():this.stopBackgroundSound()}playBackgroundSoundFadeIn(o=1e3){if(this.backgroundSound){this.backgroundSound.volume=0,this.backgroundSound.play().catch(d=>console.warn(d));let e=.05,t=o/(1/e),u=setInterval(()=>{this.backgroundSound.volume<1?this.backgroundSound.volume=Math.min(1,this.backgroundSound.volume+e):clearInterval(u)},t)}}stopBackgroundSoundFadeOut(o=1e3){if(this.backgroundSound){let e=.05,t=o/(1/e),u=setInterval(()=>{this.backgroundSound.volume>0?this.backgroundSound.volume=Math.max(0,this.backgroundSound.volume-e):(clearInterval(u),this.backgroundSound.pause(),this.backgroundSound.currentTime=0)},t)}}playBackgroundSound(){this.backgroundSound&&this.backgroundSound.play().catch(o=>console.warn("Sound konnte nicht abgespielt werden:",o))}stopBackgroundSound(){this.backgroundSound&&this.backgroundSound.pause()}generateWall(o,e,t,u){const d=[];switch(u){case"top":case"bottom":for(let r=o.x;r<=e.x;r+=t)d.push(`${r},${o.y}`);break;case"left":case"right":for(let r=o.y;r<=e.y;r+=t)d.push(`${o.x},${r}`);break}return d}}
