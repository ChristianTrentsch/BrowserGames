"use strict";import{GameObject as m}from"../../GameObject.js";import{gridCells as i}from"../../helpers/grid.js";import{SaveGame as s}from"../../SaveGame.js";import{storyFlags as c}from"../../StoryFlags.js";export class Level extends m{constructor(e,o,t=.5){super(e),o&&(this.backgroundSound=new Audio(o),this.backgroundSound.loop=!0,this.backgroundSound.volume=t),this.noResourceZones=[]}addChildrenGroup(e,o,t,u,d=[]){const r=Math.floor(o/i(1)),a=Math.floor(t/i(1));u.forEach(n=>{n.position.x+=o,n.position.y+=t,this.addChild(n)});const l=d.map(n=>({x1:n.x1+r,y1:n.y1+a,x2:n.x2+r,y2:n.y2+a}));this.noResourceZones||(this.noResourceZones=[]),this.noResourceZones.push(...l)}checkGameProgress(){s.isInEquipment("rodPurple")&&c.add("STORY_01_PART_01"),s.isInEquipment("rodRed")&&c.add("STORY_02_PART_01")}initBackgroundSound(){s.loadSound()==="on"?this.playBackgroundSound():this.stopBackgroundSound()}playBackgroundSoundFadeIn(e=1e3){if(this.backgroundSound){this.backgroundSound.volume=0,this.backgroundSound.play().catch(d=>console.warn(d));let o=.05,t=e/(1/o),u=setInterval(()=>{this.backgroundSound.volume<1?this.backgroundSound.volume=Math.min(1,this.backgroundSound.volume+o):clearInterval(u)},t)}}stopBackgroundSoundFadeOut(e=1e3){if(this.backgroundSound){let o=.05,t=e/(1/o),u=setInterval(()=>{this.backgroundSound.volume>0?this.backgroundSound.volume=Math.max(0,this.backgroundSound.volume-o):(clearInterval(u),this.backgroundSound.pause(),this.backgroundSound.currentTime=0)},t)}}playBackgroundSound(){this.backgroundSound&&this.backgroundSound.play().catch(e=>console.warn("Sound konnte nicht abgespielt werden:",e))}stopBackgroundSound(){this.backgroundSound&&this.backgroundSound.pause()}generateWall(e,o,t,u){const d=[];switch(u){case"top":case"bottom":for(let r=e.x;r<=o.x;r+=t)d.push(`${r},${e.y}`);break;case"left":case"right":for(let r=e.y;r<=o.y;r+=t)d.push(`${e.x},${r}`);break}return d}}
