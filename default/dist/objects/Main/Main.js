"use strict";import{GameObject as s}from"../../GameObject.js";import{Camera as a}from"../../Camera.js";import{Input as m}from"../../Input.js";import{Inventory as l}from"../Inventory/Inventory.js";import{events as o,CHANGE_LEVEL as p,HERO_REQUESTS_ACTION as d,TEXTBOX_START as f,TEXTBOX_END as v,HERO_ATTACK_ACTION as h}from"../../Events.js";import{SpriteTextString as C}from"../SpriteTextString/SpriteTextString.js";import{Vector2 as c}from"../../Vector2.js";import{SaveGame as u}from"../../SaveGame.js";import{Tree as g}from"../../levels/parts/Tree/Tree.js";import{Bush as x}from"../../levels/parts/Bush/Bush.js";import{Stone as T}from"../../levels/parts/Stone/Stone.js";export class Main extends s{constructor(t){super(t),this.level=null,this.input=new m,this.camera=new a(new c(0,0))}ready(){const t=new l;this.addChild(t),o.on(p,this,e=>{u.saveLevel(e.levelId),this.setLevel(e)}),o.on(d,this,e=>{if(typeof e.getContent=="function"){const r=e.getContent(),n=new C(r.portraitFrame,r.string);this.addChild(n),o.emit(f);const i=o.on(v,this,()=>{n.destroy(),o.off(i)})}}),o.on(h,this,e=>{(e instanceof g||e instanceof T||e instanceof x)&&e.destroy()})}setLevel(t){this.level&&this.level.destroy(),this.level=t,this.addChild(this.level)}drawBackground(t){this.level&&this.level.background.drawImage(t,this.level.background.position.x,this.level.background.position.x)}drawObjects(t){this.children.forEach(e=>{e.drawLayer!=="HUD"&&e.draw(t,e.position.x,e.position.x)})}drawForeground(t){this.children.forEach(e=>{e.drawLayer==="HUD"&&e.draw(t,e.position.x,e.position.x)})}}
