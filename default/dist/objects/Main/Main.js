"use strict";import{GameObject as s}from"../../GameObject.js";import{Camera as a}from"../../Camera.js";import{Input as l}from"../../Input.js";import{Inventory as m}from"../Inventory/Inventory.js";import{events as o,CHANGE_LEVEL as d,HERO_REQUESTS_ACTION as p,TEXTBOX_START as v,TEXTBOX_END as f}from"../../Events.js";import{SpriteTextString as h}from"../SpriteTextString/SpriteTextString.js";import{Vector2 as c}from"../../Vector2.js";import{SaveGame as u}from"../../SaveGame.js";export class Main extends s{constructor(t){super(t),this.level=null,this.input=new l,this.camera=new a(new c(0,0))}ready(){const t=new m;this.addChild(t),o.on(d,this,e=>{u.saveLevel(e.levelId),this.setLevel(e)}),o.on(p,this,e=>{if(typeof e.getContent=="function"){const r=e.getContent(),n=new h(r.portraitFrame,r.string);this.addChild(n),o.emit(v);const i=o.on(f,this,()=>{n.destroy(),o.off(i)})}})}setLevel(t){this.level&&this.level.destroy(),this.level=t,this.addChild(this.level)}drawBackground(t){this.level&&this.level.background.drawImage(t,this.level.background.position.x,this.level.background.position.x)}drawObjects(t){this.children.forEach(e=>{e.drawLayer!=="HUD"&&e.draw(t,e.position.x,e.position.x)})}drawForeground(t){this.children.forEach(e=>{e.drawLayer==="HUD"&&e.draw(t,e.position.x,e.position.x)})}}
