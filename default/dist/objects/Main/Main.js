"use strict";import{GameObject as a,HUD as i}from"../../GameObject.js";import{Camera as l}from"../../Camera.js";import{Input as m}from"../../Input.js";import{Inventory as d}from"../Inventory/Inventory.js";import{events as o,CHANGE_LEVEL as p,HERO_REQUESTS_ACTION as v,TEXTBOX_START as f,TEXTBOX_END as h}from"../../Events.js";import{SpriteTextString as c}from"../SpriteTextString/SpriteTextString.js";import{Vector2 as u}from"../../Vector2.js";import{SaveGame as C}from"../../SaveGame.js";export class Main extends a{constructor(t){super(t),this.level=null,this.input=new m,this.camera=new l(new u(0,0))}ready(){const t=new d;this.addChild(t),o.on(p,this,e=>{C.saveLevel(e.levelId),this.setLevel(e)}),o.on(v,this,e=>{if(typeof e.getContent=="function"){const r=e.getContent(),n=new c(r.portraitFrame,r.string);this.addChild(n),o.emit(f);const s=o.on(h,this,()=>{n.destroy(),o.off(s)})}})}setLevel(t){this.level&&this.level.destroy(),this.level=t,this.addChild(this.level)}drawBackground(t){this.level&&this.level.background.drawImage(t,this.level.background.position.x,this.level.background.position.x)}drawObjects(t){this.children.forEach(e=>{e.drawLayer!==i&&e.draw(t,e.position.x,e.position.x)})}drawForeground(t){this.children.forEach(e=>{e.drawLayer===i&&e.draw(t,e.position.x,e.position.x)})}}
