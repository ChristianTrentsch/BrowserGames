"use strict";import{events as p,HERO_CHANGE_EXP as c}from"../../Events.js";import{GameObject as f}from"../../GameObject.js";import{resources as m}from"../../Resource.js";import{SaveGame as x}from"../../SaveGame.js";import{Sprite as l}from"../../Sprite.js";import{Vector2 as o}from"../../Vector2.js";import{LEVEL_THRESHOLDS as d}from"../Hero/Hero.js";import{getCharacterFrame as v,getCharacterWidth as E}from"../SpriteTextString/spriteFontMap.js";export class Exp extends f{constructor(){super(new o(0,0)),this.drawLayer="HUD";const e=x.loadHero();this.exp=e?.exp?e.exp:0,this.level=e?.level?e.level:0,this.renderExp()}ready(){p.on(c,this,e=>{this.exp=e.exp,this.level=e.level,this.renderExp()})}renderExp(){if(this.children.forEach(r=>r.destroy()),this.addChild(new l({resource:m.images.expBackground,position:new o(40,140),frameSize:new o(240,24),frame:0})),this.level>0){let r=String(this.level),s=38;const a=136;r="Lv:"+r;for(const i of r){const n=E(i),t=new l({position:new o(s,a),resource:m.images.fontBlack,hFrames:13,vFrames:6,frame:v(i)});this.addChild(t),s+=n+1}}const e=d[this.level];if(e){const s=this.exp/e,a=Math.min(s,1);let i=Math.floor(a*234);const n=1;for(let t=0;t<i;t++){const h=t*n;this.addChild(new l({resource:m.images.exp,position:new o(h+43,151),frameSize:new o(n,2),hFrames:240,frame:t}))}}}}
