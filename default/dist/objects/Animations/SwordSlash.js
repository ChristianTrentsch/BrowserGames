"use strict";import{GameObject as d}from"./../../GameObject.js";import{Vector2 as s}from"./../../Vector2.js";import{LEFT as f,RIGHT as p,UP as w,DOWN as l}from"./../../Input.js";import{Sprite as k}from"../../Sprite.js";import{resources as u}from"../../Resource.js";import{Animations as h}from"../../Animations.js";import{FrameIndexPattern as t}from"../../FrameIndexPattern.js";import{WALK_LEFT as A,WALK_DOWN as D,WALK_UP as b,WALK_RIGHT as y,STAND_LEFT as W,STAND_DOWN as T,STAND_UP as L,STAND_RIGHT as _,PICK_UP_DOWN as S,ATTACK_WALK_DOWN as K,ATTACK_WALK_LEFT as g,ATTACK_WALK_RIGHT as U,ATTACK_WALK_UP as N}from"../Hero/heroAnimations.js";import{SaveGame as C}from"../../SaveGame.js";export class SwordSlash extends d{constructor(e,n){super(new s(0,0));this.lifetime=480;this.facingDirection=n,this.drawLayer="HUD",this.body=new k({resource:u.images.sword,position:new s(-8,-8),frameSize:new s(32,32),hFrames:6,vFrames:4,frame:1,animations:new h({walkLeft:new t(A),walkDown:new t(D),walkUp:new t(b),walkRight:new t(y),standLeft:new t(W),standDown:new t(T),standUp:new t(L),standRight:new t(_),pickUpDown:new t(S),attackWalkDown:new t(K),attackWalkRight:new t(U),attackWalkUp:new t(N),attackWalkLeft:new t(g)})}),this.addChild(this.body);const a=SwordSlash.attackSlices[Math.floor(Math.random()*SwordSlash.attackSlices.length)];if(a&&C.loadSound()==="on"&&this.playSoundSlice(a[0],a[1]),this.body.animations){switch(this.facingDirection){case f:this.body.animations.play("attackWalkLeft");break;case p:this.body.animations.play("attackWalkRight");break;case w:this.body.animations.play("attackWalkUp");break;case l:this.body.animations.play("attackWalkDown");break}return}}static{this.attackSlices=[[.2,.6],[3,3.4],[5.6,6]]}static{this.sliceIndex=0}step(e){this.lifetime-=e,this.lifetime<=0&&this.destroy()}destroy(){super.destroy()}async playSoundSlice(e,n){const c=await(await fetch("./sounds/items/sword_attack01.mp3")).arrayBuffer(),i=new AudioContext,m=await i.decodeAudioData(c),o=i.createBufferSource();o.buffer=m;const r=i.createGain();r.gain.value=.2,o.connect(r),r.connect(i.destination),o.start(0,e,n-e)}}
