"use strict";import{GameObject as f}from"./../../GameObject.js";import{Vector2 as s}from"./../../Vector2.js";import{LEFT as p,RIGHT as d,UP as l,DOWN as w}from"./../../Input.js";import{Sprite as k}from"../../Sprite.js";import{resources as u}from"../../Resource.js";import{Animations as A}from"../../Animations.js";import{FrameIndexPattern as e}from"../../FrameIndexPattern.js";import{WALK_LEFT as D,WALK_DOWN as b,WALK_UP as h,WALK_RIGHT as y,STAND_LEFT as W,STAND_DOWN as T,STAND_UP as L,STAND_RIGHT as _,PICK_UP_DOWN as K,ATTACK_WALK_DOWN as g,ATTACK_WALK_LEFT as U,ATTACK_WALK_RIGHT as I,ATTACK_WALK_UP as N}from"../Hero/heroAnimations.js";export class SwordSlash extends f{constructor(t,n){super(new s(0,0));this.lifetime=480;this.facingDirection=n,this.drawLayer="HUD",this.body=new k({resource:u.images.sword,position:new s(-8,-8),frameSize:new s(32,32),hFrames:6,vFrames:4,frame:1,animations:new A({walkLeft:new e(D),walkDown:new e(b),walkUp:new e(h),walkRight:new e(y),standLeft:new e(W),standDown:new e(T),standUp:new e(L),standRight:new e(_),pickUpDown:new e(K),attackWalkDown:new e(g),attackWalkRight:new e(I),attackWalkUp:new e(N),attackWalkLeft:new e(U)})}),this.addChild(this.body);const a=SwordSlash.attackSlices[SwordSlash.sliceIndex];if(a&&(console.log(a),this.playSoundSlice(a[0],a[1])),SwordSlash.sliceIndex=(SwordSlash.sliceIndex+1)%SwordSlash.attackSlices.length,this.body.animations){switch(this.facingDirection){case p:this.body.animations.play("attackWalkLeft");break;case d:this.body.animations.play("attackWalkRight");break;case l:this.body.animations.play("attackWalkUp");break;case w:this.body.animations.play("attackWalkDown");break}return}}static{this.attackSlices=[[.2,.6],[3,3.4],[5.6,6]]}static{this.sliceIndex=0}step(t){this.lifetime-=t,this.lifetime<=0&&this.destroy()}destroy(){super.destroy()}async playSoundSlice(t,n){const c=await(await fetch("./sounds/items/sword_attack01.mp3")).arrayBuffer(),i=new AudioContext,m=await i.decodeAudioData(c),o=i.createBufferSource();o.buffer=m;const r=i.createGain();r.gain.value=.2,o.connect(r),r.connect(i.destination),o.start(0,t,n-t)}}
