"use strict";import{GameObject as a,HUD as y}from"../../GameObject.js";import{resources as s}from"../../Resource.js";import{Sprite as h}from"../../Sprite.js";import{Vector2 as m}from"../../Vector2.js";import{events as o,HERO_PICKS_UP_ITEM as d,HERO_USE_ITEM as g}from"../../Events.js";import{SaveGame as n}from"../../SaveGame.js";export class Inventory extends a{constructor(){super(new m(0,1)),this.drawLayer=y,this.nextId=0,this.items=n.loadInventory().map(e=>({...e,image:s.images[e.imageKey]})),this.items.length>0&&(this.nextId=Math.max(...this.items.map(e=>e.id))),this.renderInventory()}ready(){o.on(d,this,e=>{const{imageKey:t}=e;if(this.items.some(i=>i.imageKey===t)){console.warn(`Item ${t} ist bereits im Inventar`);return}this.nextId+=1,this.items.push({id:this.nextId,image:s.images[t],imageKey:t}),n.saveInventory(this.items.map(i=>({id:i.id,imageKey:i.imageKey}))),this.renderInventory()}),o.on(g,this,e=>{const{imageKey:t}=e;this.removeFromInventory(t)})}renderInventory(){this.children.forEach(e=>e.destroy()),this.items.forEach((e,t)=>{const r=new h({resource:s.images[e.imageKey],position:new m(t*12,0)});this.addChild(r)})}removeFromInventory(e){this.items=this.items.filter(t=>t.imageKey!==e),this.renderInventory()}}
