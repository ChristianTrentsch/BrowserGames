"use strict";import{gridCells as t,TILE_SIZE as i}from"../helpers/grid.js";import{resources as n}from"../Resource.js";import{Vector2 as e}from"../Vector2.js";import{Sprite as s}from"../Sprite.js";import{Level as c}from"../objects/Level/Level.js";import{Exit as g}from"../objects/Exit/Exit.js";import{Hero as w}from"../objects/Hero/Hero.js";import{events as a,HERO_EXITS as R,CHANGE_LEVEL as T}from"../Events.js";import{OutdoorLevel1 as v}from"./OutdoorLevel1.js";import{Npc as d}from"../objects/Npc/Npc.js";import{Item as P}from"../objects/Item/Item.js";import{SaveGame as r}from"../SaveGame.js";import{storyFlags as l}from"../StoryFlags.js";export class CaveLevel1 extends c{constructor({position:m,heroPosition:u}){super(m,"./sounds/levels/CaveLevel1.mp3",.2);this.defaultHeroPosition=new e(t(5),t(2));this.levelId="CaveLevel1";this.initBackgroundSound(),this.background=new s({resource:n.images.caveSky,frameSize:new e(320,180),position:new e(0,0)});const h=new s({resource:n.images.caveGround,frameSize:new e(320,180),position:new e(0,0)});this.addChild(h);const f=new g(t(17),t(7));this.addChild(f),this.heroStartPosition=r.loadHero(this.levelId,u??this.defaultHeroPosition);const p=new w(this.heroStartPosition.x,this.heroStartPosition.y);this.addChild(p);let o=new d(t(6),t(2),[{string:"Du hast nun die st\xE4rkste Waffe und keine Ressource kann dich aufhalten",requires:["STORY_01_PART_01","STORY_02_PART_01"]},{string:"Bringe mir 20x Bl\xE4tter, 25x Holz, 10x Steine und die ultimative Waffe geh\xF6rt dir!",requires:["STORY_01_PART_01"],storyFlag:"STORY_02_PART_01"},{string:"Sprich zuerst mit meinem Bruder!"}]);if(r.isInEquipment("rodPurple")&&l.add("STORY_01_PART_01"),r.isInEquipment("rodRed")&&l.add("STORY_02_PART_01"),!r.isInEquipment("rodRed")){const S=new P(t(7),t(3),"rodRed");this.addChild(S),o=new d(t(7),t(2),[{string:"Du hast nun die st\xE4rkste Waffe und keine Ressource kann dich aufhalten",requires:["STORY_01_PART_01","STORY_02_PART_01"]},{string:"Bringe mir 20x Bl\xE4tter, 25x Holz, 10x Steine und die ultimative Waffe geh\xF6rt dir!",requires:["STORY_01_PART_01"],storyFlag:"STORY_02_PART_01"},{string:"Sprich zuerst mit meinem Bruder!"}])}this.addChild(o);const _={right:this.generateWall(new e(288,16),new e(288,112),i,"right"),left:this.generateWall(new e(16,16),new e(16,112),i,"left"),top:this.generateWall(new e(32,0),new e(272,0),i,"top"),bottom:this.generateWall(new e(32,128),new e(272,128),i,"bottom"),stone:["144,16","192,32","208,32","208,48","256,80","32,64"],littleStone:["48,64","48,80"],squares:["48,13","64,16","80,48","96,48","128,48","112,64","96,64","192,80","208,80","224,96"],water:["240,32","256,32","208,96","192,96","176,96","128,96","112,96","96,96"]};this.walls=new Set(Object.values(_).flat())}ready(){a.on(R,this,()=>{this.stopBackgroundSound(),a.emit(T,new v({position:new e(t(0),t(0)),heroPosition:new e(t(11),t(4))}))})}}
